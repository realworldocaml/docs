<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>DH (cryptokit.Cryptokit.DH)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><header><nav><a href="../index.html">Up</a> â€“ package <a href="../../index.html">cryptokit</a></nav><h1>Module <code>Cryptokit.DH</code></h1></header><div class="doc"><p>The <code>DH</code> module implements Diffie-Hellman key agreement. Key agreement is a protocol by which two parties can establish a shared secret (typically a key for a symmetric cipher or MAC) by exchanging messages, with the guarantee that even if an attacker eavesdrop on the messages, he cannot recover the shared secret. Diffie-Hellman is one such key agreement protocol, relying on the difficulty of computing discrete logarithms. Notice that the Diffie-Hellman protocol is vulnerable to active attacks (man-in-the-middle attacks).</p><p>The protocol executes as follows:</p><ul><li>Both parties must agree beforehand on a set of public parameters (type <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.parameters&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.parameters</span>). Suitable parameters can be generated by calling <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.new_parameters&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.new_parameters</span>, or fixed parameters taken from the literature can be used.</li><li>Each party computes a random private secret using the function <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.private_secret&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.private_secret</span>.</li><li>From its private secrets and the public parameters, each party computes a message (a string) with the function <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.message&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.message</span>, and sends it to the other party.</li><li>Each party recovers the shared secret by applying the function <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.shared_secret&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.shared_secret</span> to its private secret and to the message received from the other party.</li><li>Fixed-size keys can then be derived from the shared secret using the function <span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH.derive_key&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Cryptokit.DH&quot;"><code>Cryptokit</code>.DH</span>.derive_key</span>.</li></ul></div><dl><dt id="type-parameters"><a href="#type-parameters" class="anchor"></a><code><span class="keyword">type </span>parameters</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-parameters.p" class="anchored"><td class="def field"><a href="#type-parameters.p" class="anchor"></a><code>p : string;</code></td><td class="doc"><p>Large prime number</p></td></tr><tr id="type-parameters.g" class="anchored"><td class="def field"><a href="#type-parameters.g" class="anchor"></a><code>g : string;</code></td><td class="doc"><p>Generator of <code>Z/pZ</code></p></td></tr><tr id="type-parameters.privlen" class="anchored"><td class="def field"><a href="#type-parameters.privlen" class="anchor"></a><code>privlen : int;</code></td><td class="doc"><p>Length of private secrets in bits</p></td></tr></table><code>}</code><code></code></dt><dd><p>The type of Diffie-Hellman parameters. These parameters need to be agreed upon by the two parties before the key agreement protocol is run. The parameters are public and can be reused for several runs of the protocol.</p></dd></dl><dl><dt id="val-new_parameters"><a href="#val-new_parameters" class="anchor"></a><code><span class="keyword">val </span>new_parameters : ?&#8288;rng:<a href="../Random/class-type-rng/index.html">Random.rng</a> <span>&#8209;&gt;</span> ?&#8288;privlen:int <span>&#8209;&gt;</span> int <span>&#8209;&gt;</span> <a href="index.html#type-parameters">parameters</a></code></dt><dd><p>The type of Diffie-Hellman parameters. These parameters need to be agreed upon by the two parties before the key agreement protocol is run. The parameters are public and can be reused for several runs of the protocol.</p><p>Generate a new set of Diffie-Hellman parameters. The non-optional argument is the size in bits of the <code>p</code> parameter. It must be large enough that the discrete logarithm problem modulo <code>p</code> is computationally unsolvable. 1024 is a reasonable value. The optional <code>rng</code> argument specifies a random number generator to use for generating the parameters; it defaults to <a href="../Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>. The optional <code>privlen</code> argument is the size in bits of the private secrets that are generated during the key agreement protocol; the default is 160.</p></dd></dl><dl><dt id="type-private_secret"><a href="#type-private_secret" class="anchor"></a><code><span class="keyword">type </span>private_secret</code><code></code><code></code></dt><dd><p>Generate a new set of Diffie-Hellman parameters. The non-optional argument is the size in bits of the <code>p</code> parameter. It must be large enough that the discrete logarithm problem modulo <code>p</code> is computationally unsolvable. 1024 is a reasonable value. The optional <code>rng</code> argument specifies a random number generator to use for generating the parameters; it defaults to <a href="../Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>. The optional <code>privlen</code> argument is the size in bits of the private secrets that are generated during the key agreement protocol; the default is 160.</p><p>The abstract type of private secrets generated during key agreement.</p></dd></dl><dl><dt id="val-private_secret"><a href="#val-private_secret" class="anchor"></a><code><span class="keyword">val </span>private_secret : ?&#8288;rng:<a href="../Random/class-type-rng/index.html">Random.rng</a> <span>&#8209;&gt;</span> <a href="index.html#type-parameters">parameters</a> <span>&#8209;&gt;</span> <a href="index.html#type-private_secret">private_secret</a></code></dt><dd><p>The abstract type of private secrets generated during key agreement.</p><p>Generate a random private secret. The optional <code>rng</code> argument specifies a random number generator to use; it defaults to <a href="../Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>.</p></dd></dl><dl><dt id="val-message"><a href="#val-message" class="anchor"></a><code><span class="keyword">val </span>message : <a href="index.html#type-parameters">parameters</a> <span>&#8209;&gt;</span> <a href="index.html#type-private_secret">private_secret</a> <span>&#8209;&gt;</span> string</code></dt><dd><p>Generate a random private secret. The optional <code>rng</code> argument specifies a random number generator to use; it defaults to <a href="../Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>.</p><p>Compute the message to be sent to the other party.</p></dd></dl><dl><dt id="val-shared_secret"><a href="#val-shared_secret" class="anchor"></a><code><span class="keyword">val </span>shared_secret : <a href="index.html#type-parameters">parameters</a> <span>&#8209;&gt;</span> <a href="index.html#type-private_secret">private_secret</a> <span>&#8209;&gt;</span> string <span>&#8209;&gt;</span> string</code></dt><dd><p>Compute the message to be sent to the other party.</p><p>Recover the shared secret from the private secret of the present party and the message received from the other party. The shared secret returned is a string of the same length as the <code>p</code> parameter. The private secret is destroyed and can no longer be used afterwards.</p></dd></dl><dl><dt id="val-derive_key"><a href="#val-derive_key" class="anchor"></a><code><span class="keyword">val </span>derive_key : ?&#8288;diversification:string <span>&#8209;&gt;</span> string <span>&#8209;&gt;</span> int <span>&#8209;&gt;</span> string</code></dt><dd><p>Recover the shared secret from the private secret of the present party and the message received from the other party. The shared secret returned is a string of the same length as the <code>p</code> parameter. The private secret is destroyed and can no longer be used afterwards.</p><p><code>derive_key shared_secret numbytes</code> derives a secret string (typically, a key for symmetric encryption) from the given shared secret. <code>numbytes</code> is the desired length for the returned string. The optional <code>diversification</code> argument is an arbitrary string that defaults to the empty string. Different secret strings can be obtained from the same shared secret by supplying different <code>diversification</code> argument. The computation of the secret string is performed by SHA-1 hashing of the diversification string, followed by the shared secret, followed by an integer counter. The hashing is repeated with increasing values of the counter until <code>numbytes</code> bytes have been obtained.</p></dd></dl></body></html>