<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>cipher (cryptokit.Cryptokit.Block.cipher)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><header><nav><a href="../index.html">Up</a> â€“ package <a href="../../../index.html">cryptokit</a></nav><h1>Class <code>Cryptokit.Block.cipher</code></h1></header><div class="doc"><p>Wraps a block cipher as a general transform. The transform has input block size and output block size equal to the block size of the block cipher. No padding is performed. Example: <code>new cipher (new cbc_encrypt (new aes_encrypt key))</code> returns a transform that performs AES encryption in CBC mode.</p></div><aside><p>A &lt;I&gt;transform&lt;/I&gt; is an arbitrary mapping from sequences of characters to sequences of characters. Examples of transforms include ciphering, deciphering, compression, decompression, and encoding of binary data as text. Input data to a transform is provided by successive calls to the methods <code>put_substring</code>, <code>put_string</code>, <code>put_char</code> or <code>put_byte</code>. The result of transforming the input data is buffered internally, and can be obtained via the <code>get_string</code>, <code>get_substring</code>, <code>get_char</code> and <code>get_byte</code> methods.</p></aside><dl><dt id="method-put_substring"><a href="#method-put_substring" class="anchor"></a><code><span class="keyword">method </span>put_substring : bytes <span>&#8209;&gt;</span> int <span>&#8209;&gt;</span> int <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>put_substring b pos len</code> processes <code>len</code> characters of byte sequence <code>b</code>, starting at character number <code>pos</code>, through the transform.</p></dd></dl><dl><dt id="method-put_string"><a href="#method-put_string" class="anchor"></a><code><span class="keyword">method </span>put_string : string <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>put_substring b pos len</code> processes <code>len</code> characters of byte sequence <code>b</code>, starting at character number <code>pos</code>, through the transform.</p><p><code>put_string str</code> processes all characters of string <code>str</code> through the transform.</p></dd></dl><dl><dt id="method-put_char"><a href="#method-put_char" class="anchor"></a><code><span class="keyword">method </span>put_char : char <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>put_string str</code> processes all characters of string <code>str</code> through the transform.</p><p><code>put_char c</code> processes character <code>c</code> through the transform.</p></dd></dl><dl><dt id="method-put_byte"><a href="#method-put_byte" class="anchor"></a><code><span class="keyword">method </span>put_byte : int <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>put_char c</code> processes character <code>c</code> through the transform.</p><p><code>put_byte b</code> processes the character having code <code>b</code> through the transform. <code>b</code> must be between <code>0</code> and <code>255</code> inclusive.</p></dd></dl><dl><dt id="method-finish"><a href="#method-finish" class="anchor"></a><code><span class="keyword">method </span>finish : unit</code></dt><dd><p><code>put_byte b</code> processes the character having code <code>b</code> through the transform. <code>b</code> must be between <code>0</code> and <code>255</code> inclusive.</p><p>Call method <code>finish</code> to indicate that no further data will be processed through the transform. This causes the transform to flush its internal buffers and perform all appropriate finalization actions, e.g. add final padding. Raise <code>Error
          Wrong_data_length</code> if the total length of input data provided via the <code>put_*</code> methods is not an integral number of the input block size (see <a href="../../class-type-transform/index.html#method-input_block_size"><code>Cryptokit.transform.input_block_size</code></a>). After calling <code>finish</code>, the transform can no longer accept additional data. Hence, do not call any of the <code>put_*</code> methods nor <code>flush</code> after calling <code>finish</code>.</p></dd></dl><dl><dt id="method-flush"><a href="#method-flush" class="anchor"></a><code><span class="keyword">method </span>flush : unit</code></dt><dd><p>Call method <code>finish</code> to indicate that no further data will be processed through the transform. This causes the transform to flush its internal buffers and perform all appropriate finalization actions, e.g. add final padding. Raise <code>Error
          Wrong_data_length</code> if the total length of input data provided via the <code>put_*</code> methods is not an integral number of the input block size (see <a href="../../class-type-transform/index.html#method-input_block_size"><code>Cryptokit.transform.input_block_size</code></a>). After calling <code>finish</code>, the transform can no longer accept additional data. Hence, do not call any of the <code>put_*</code> methods nor <code>flush</code> after calling <code>finish</code>.</p><p><code>flush</code> causes the transform to flush its internal buffers and make all output processed up to this point available through the <code>get_*</code> methods. Raise <code>Error Wrong_data_length</code> if the total length of input data provided via the <code>put_*</code> methods is not an integral number of the input block size (see <a href="../../class-type-transform/index.html#method-input_block_size"><code>Cryptokit.transform.input_block_size</code></a>). (For padded block ciphers, the input block size used here is that of the underlying block cipher, without the padding.) Unlike method <code>finish</code>, method <code>flush</code> does not add final padding and leaves the transform in a state where it can still accept more input.</p></dd></dl><dl><dt id="method-available_output"><a href="#method-available_output" class="anchor"></a><code><span class="keyword">method </span>available_output : int</code></dt><dd><p><code>flush</code> causes the transform to flush its internal buffers and make all output processed up to this point available through the <code>get_*</code> methods. Raise <code>Error Wrong_data_length</code> if the total length of input data provided via the <code>put_*</code> methods is not an integral number of the input block size (see <a href="../../class-type-transform/index.html#method-input_block_size"><code>Cryptokit.transform.input_block_size</code></a>). (For padded block ciphers, the input block size used here is that of the underlying block cipher, without the padding.) Unlike method <code>finish</code>, method <code>flush</code> does not add final padding and leaves the transform in a state where it can still accept more input.</p><p>Return the number of characters of output currently available. The output can be recovered with the <code>get_*</code> methods.</p></dd></dl><dl><dt id="method-get_string"><a href="#method-get_string" class="anchor"></a><code><span class="keyword">method </span>get_string : string</code></dt><dd><p>Return the number of characters of output currently available. The output can be recovered with the <code>get_*</code> methods.</p><p>Return a character string containing all output characters available at this point. The internal output buffer is emptied; in other terms, all currently available output is consumed (and returned to the caller) by a call to <code>get_string</code>.</p></dd></dl><dl><dt id="method-get_substring"><a href="#method-get_substring" class="anchor"></a><code><span class="keyword">method </span>get_substring : bytes<span class="keyword"> * </span>int<span class="keyword"> * </span>int</code></dt><dd><p>Return a character string containing all output characters available at this point. The internal output buffer is emptied; in other terms, all currently available output is consumed (and returned to the caller) by a call to <code>get_string</code>.</p><p>Return a triple <code>(buf,pos,len)</code>, where <code>buf</code> is the internal output buffer for the transform, <code>pos</code> the position of the first character of available output, and <code>len</code> the number of characters of available output. The byte array <code>buf</code> will be modified later, so the caller must immediately copy characters <code>pos</code> to <code>pos+len-1</code> of <code>buf</code> to some other location. The internal output buffer is emptied; in other terms, all currently available output is consumed (and returned to the caller) by a call to <code>get_substring</code>.</p></dd></dl><dl><dt id="method-get_char"><a href="#method-get_char" class="anchor"></a><code><span class="keyword">method </span>get_char : char</code></dt><dd><p>Return a triple <code>(buf,pos,len)</code>, where <code>buf</code> is the internal output buffer for the transform, <code>pos</code> the position of the first character of available output, and <code>len</code> the number of characters of available output. The byte array <code>buf</code> will be modified later, so the caller must immediately copy characters <code>pos</code> to <code>pos+len-1</code> of <code>buf</code> to some other location. The internal output buffer is emptied; in other terms, all currently available output is consumed (and returned to the caller) by a call to <code>get_substring</code>.</p><p>Return the first character of output, and remove it from the internal output buffer. Raise <code>End_of_file</code> if no output is currently available.</p></dd></dl><dl><dt id="method-get_byte"><a href="#method-get_byte" class="anchor"></a><code><span class="keyword">method </span>get_byte : int</code></dt><dd><p>Return the first character of output, and remove it from the internal output buffer. Raise <code>End_of_file</code> if no output is currently available.</p><p>Return the code of the first character of output, and remove it from the internal output buffer. Raise <code>End_of_file</code> if no output is currently available.</p></dd></dl><dl><dt id="method-input_block_size"><a href="#method-input_block_size" class="anchor"></a><code><span class="keyword">method </span>input_block_size : int</code></dt><dd><p>Return the code of the first character of output, and remove it from the internal output buffer. Raise <code>End_of_file</code> if no output is currently available.</p><p>Some transforms (e.g. unpadded block ciphers) process input data by blocks of several characters. This method returns the size of input blocks for the current transform. If <code>input_block_size &gt; 1</code>, the user of the transform must ensure that the total length of input data provided between calls to <code>flush</code> and <code>finish</code> is an integral multiple of <code>input_block_size</code>. If <code>input_block_size = 1</code>, the transform can accept input data of arbitrary length.</p></dd></dl><dl><dt id="method-output_block_size"><a href="#method-output_block_size" class="anchor"></a><code><span class="keyword">method </span>output_block_size : int</code></dt><dd><p>Some transforms (e.g. unpadded block ciphers) process input data by blocks of several characters. This method returns the size of input blocks for the current transform. If <code>input_block_size &gt; 1</code>, the user of the transform must ensure that the total length of input data provided between calls to <code>flush</code> and <code>finish</code> is an integral multiple of <code>input_block_size</code>. If <code>input_block_size = 1</code>, the transform can accept input data of arbitrary length.</p><p>Some transforms (e.g. block ciphers) always produce output data by blocks of several characters. This method returns the size of output blocks for the current transform. If <code>output_block_size &gt; 1</code>, the total length of output data produced by the transform is always an integral multiple of <code>output_block_size</code>. If <code>output_block_size = 1</code>, the transform produces output data of arbitrary length.</p></dd></dl><dl><dt id="method-wipe"><a href="#method-wipe" class="anchor"></a><code><span class="keyword">method </span>wipe : unit</code></dt><dd><p>Some transforms (e.g. block ciphers) always produce output data by blocks of several characters. This method returns the size of output blocks for the current transform. If <code>output_block_size &gt; 1</code>, the total length of output data produced by the transform is always an integral multiple of <code>output_block_size</code>. If <code>output_block_size = 1</code>, the transform produces output data of arbitrary length.</p><p>Erase all internal buffers and data structures of this transform, overwriting them with zeroes. A transform may contain sensitive data such as secret key-derived material, or parts of the input or output data. Calling <code>wipe</code> ensures that this sensitive data will not remain in memory longer than strictly necessary, thus making invasive attacks more difficult. It is thus prudent practice to call <code>wipe</code> on every transform that the program no longer needs. After calling <code>wipe</code>, the transform is no longer in a working state: do not call any other methods after calling <code>wipe</code>.</p></dd></dl></body></html>